Сегодняшнее занятие достаточно простое — мы научимся работать с числами с плавающей точкой (то есть с действительными числами).

# 1.6 Действительные числа

## Содержание
+ [Как хранятся действительные числа в компьютере](#как-хранятся-действительные-числа-в-компьютере)
+ [Операции с действительными числами](#операции-с-действительными-числами)
+ [Из действительных в целые](#из-действительных-в-целые)
    + [Функция `trunc`](#функция-trunc)
    + [Функция `floor`](#функция-floor)
    + [Функция `ceil`](#функция-ceil)
    + [Функция `round`](#функция-round)
+ [Полезные функции библиотеки cmath](#полезные-функции-библиотеки-cmath)
+ [Задачи]
    + [Дано положительное действительное число X. Выведите его дробную часть.](#дано-положительное-действительное-число-x-выведите-его-дробную-часть)
    + [Дано положительное действительное число X. Выведите его первую цифру после десятичной точки.](#дано-положительное-действительное-число-x-выведите-его-первую-цифру-после-десятичной-точки)
    + [Даны длины сторон треугольника. Вычислите площадь треугольника.](#даны-длины-сторон-треугольника-вычислите-площадь-треугольника)
    + [Процентная ставка по вкладу составляет P процентов годовых, которые прибавляются к сумме вклада в конце года.](#процентная-ставка-по-вкладу-составляет-p-процентов-годовых-которые-прибавляются-к-сумме-вклада-в-конце-года)
    + [Процентная ставка по вкладу составляет P процентов годовых, которые прибавляются к сумме вклада через год.](#процентная-ставка-по-вкладу-составляет-p-процентов-годовых-которые-прибавляются-к-сумме-вклада-через-год)
    + [Определите среднее значение всех элементов последовательности, завершающейся числом 0.](#определите-среднее-значение-всех-элементов-последовательности-завершающейся-числом-0)
    + [Дана последовательность натуральных чисел x1, x2, ..., xn. Стандартным отклонением называется величина](#дана-последовательность-натуральных-чисел-x1-x2--xn-стандартным-отклонением-называется-величина)
    + [Дан многочлен](#дан-многочлен)
    + [Даны действительные коэффициенты a, b, c, при этом a ≠ 0 . Решите квадратное уравнение ](#даны-действительные-коэффициенты-a-b-c-при-этом-a--0--решите-квадратное-уравнение)
    + [Даны действительные коэффициенты a, b, c. Решите уравнение ](#даны-действительные-коэффициенты-a-b-c-решите-уравнение)
    + [Даны вещественные числа a, b, c, d, e, f. Известно, что система линейных уравнений](#даны-вещественные-числа-a-b-c-d-e-f-известно-что-система-линейных-уравнений)
    + [Даны вещественные числа a, b, c, d, e, f. Известно, что система линейных уравнений Множество решений](#даны-вещественные-числа-a-b-c-d-e-f-известно-что-система-линейных-уравнений-множество-решений)

[Оглавление](/Introduction_to_Programming_Cpp/README.MD)

## Как хранятся действительные числа в компьютере

Для хранения действительных чисел в памяти компьютера отводится определённое количество бит. Действительное число хранится в виде знака (плюс или минус), мантиссы и экспоненты. Что такое мантисса и экспонента лучше объяснить на примере: масса Земли равна $5.972*10^{24}$ килограмм. Здесь $5.972$ — мантисса, а $24$ — экспонента.

При выводе больших (или очень маленьких) чисел в программе на C++ можно увидеть на экране запись типа `5.972E23`. Сначала выводится мантисса, затем — буква `E`, а затем — экспонента. Запись представлена в десятичной системе счисления. В таком же формате можно вводить большие или очень маленькие действительные числа. Этот формат называется экспоненциальной записью числа. 

Мы будем работать с типом `double` (с числами двойной точности), который занимает `8` байт. Один бит отводится под знак числа, `11` под экспоненту и `52` под мантиссу. С помощью `52` бит можно хранить числа длиной до `15-16` десятичных цифр. Таким образом, независимо от того, какая у числа экспонента, правильные значения будут иметь только первые `15` цифр. В примере с массой Земли точно заданы первые `4` цифры, таким образом, погрешность составляет $10^{20}$ килограмм. Это довольно большая погрешность. Чтобы масса Земли с точностью до первых четырёх знаков изменилась, на неё нужно дополнительно поселить миллиард миллиардов довольно упитанных людей.

Таким образом, можно сказать, что числа в компьютере хранятся не с абсолютной, а с относительной погрешностью (то есть погрешность зависит от значения хранимого числа).

То, что числа хранятся неточно, создаёт нам множество проблем.

Создание, ввод и вывод действительных переменных

Работа с действительными переменными очень похожа на работу с целыми числами, только вместо типа int мы используем тип double. Чтобы создать две действительные переменные x и y, нужно написать:

```c
double x, y;
```

Если мы хотим использовать действительные числа в коде программы, то в качестве разделителя целой и дробной части нужно использовать точку:

```
y = 3.1415;
```

Считываются действительные переменные так же, как целые:

```c++
std::cin >> x;
```
При выводе действительных чисел нужно помнить о некоторых особенностях. В большинстве задач требуется выводить числа с заданной точностью. Например, если от нас требуется вывести число с точностью $10^{-3}$, значит, необходимо вывести три знака после десятичной точки. Числа с заданным количеством знаков после точки выводятся так:

```c++
#include <iomanip>
using namespace std;
cout << setprecision(3) << fixed;
```

Первая команда устанавливает точность, а вторая сообщает, что все числа нужно выводить с точкой (а не в экспоненциальной форме). После выполнения этой команды все действительные числа будут выводиться с точностью до 3 знаков после точки. Чтобы эти команды работали, необходимо подключить библиотеку `iomanip`.

<hr>

[Содержание](#содержание)

## Операции с действительными числами

Описывая эти операции, мы будем считать, что все числа в арифметических выражениях действительные. Случай, когда в выражении используются целые и действительные числа вперемешку, будет рассмотрен в следующем разделе.

Над действительными числами можно выполнять те же операции, что и над целыми (кроме взятия остатка). При этом деление действительных чисел даёт уже настоящий, не округлённый результат.

Также для действительных чисел определена функция `abs`, которая возвращает модуль числа.

Целые и действительные числа в одном арифметическом выражении

Если мы хотим сохранить в действительной переменной целое число, то достаточно присвоить переменной типа `double` значение целочисленного арифметического выражения. 

Есть одна неприятность: если оба операнда (те, что стоят слева и справа от знака операции) целые, то операция будет выполняться в целых числах. Например, если `x` – действительное число, `а`, `k` и `m` – целые и равны 2 и 3, то после выполнения строки `x = k/m` в переменной `x` окажется число `0.0`. Деление будет выполнено в целых числах, а уже после этого результат будет преобразован в действительное число. 

Чтобы избавиться от этой проблемы, необходимо явно привести один из операндов к типу `double`. Чтобы привести переменную к другому типу в C++ имя типа записывается в круглых скобках перед именем переменной. Чтобы в x оказался правильный результат, можно написать `x = (double) k/m`. Таким образом, у нас будет происходить вычисление выражения 2.0/3, а если один из операндов будет типа `double`, то второй также приведётся к этому типу.

<hr>

[Содержание](#содержание)

## Из действительных в целые

При переводе из действительных чисел в целые дробная часть теряется. Есть несколько способов потерять дробную часть. Чтобы использовать эти функции, необходимо подключить библиотеку cmath. В нашей программе, кроме `#include <iostream>`, нужно в следующей строке написать `#include <cmath>`.

### Функция `trunc`,
которая просто отбрасывает дробную часть числа и выглядит так: `n = trunc(x);`

### Функция `floor`,
которая округляет число в меньшую сторону и выглядит так: `n = floor(x);`

### Функция `ceil`,
которая округляет число в большую сторону и выглядит так: `n = ceil(x);`

### Функция `round`,
которая округляет число по математическим правилам и выглядит так: `n = round(x);`

Чтобы разница между способами была понятнее, приведём таблицу с примерами:

![01](/Introduction_to_Programming_Cpp/img/01_01.png)

<hr>

[Содержание](#содержание)

## Полезные функции библиотеки cmath

Все функции библиотеки cmath принимают параметры типа double и возвращают значения типа double. Разобьём их по типам.

![01](/Introduction_to_Programming_Cpp/img/01_02.png)

В C++ нет стандартного имени для константы `π`. Самый универсальный способ посчитать её, который будет работать во всех версиях компилятора, это взять арктангенс единицы и умножить его на `4`. Записывается это как `atan(1) * 4`.

__Во всех задачах этого занятия следует выводить числа с шестью знаками после точки.__

<hr>

[Содержание](#содержание)

## Задачи

## Дано положительное действительное число X. Выведите его дробную часть.

```c++
#include <cmath>
#include <iostream>

int main() {
    double n;

    std::cin >> n;

    double result = n - trunc(n);

    std::cout << result;
    return 0;
}
```

```c++
#include <iostream>

int main() {
    double n;

    std::cin >> n;

    double result = n - (int)n;

    std::cout << result;
    return 0;
}
```

<hr>

[Содержание](#содержание)

## Дано положительное действительное число X. Выведите его первую цифру после десятичной точки.

```c++
#include <iostream>

int main() {
    double n;

    std::cin >> n;

    double result = (int)(n * 10) % 10;

    std::cout << result;
    return 0;
}
```

<hr>

[Содержание](#содержание)

## Даны длины сторон треугольника. Вычислите площадь треугольника.

```c++
#include <iostream>
#include <cmath>

int main() {
    double a, b, c;

    std::cin >> a >> b >> c;

    double p = (a + b + c) / 2;
    double result = sqrt(p * (p - a) * (p - b) * (p - c));

    std::cout << result;
    return 0;
}
```

<hr>

[Содержание](#содержание)

## Процентная ставка по вкладу составляет P процентов годовых, которые прибавляются к сумме вклада в конце года.
Вклад составляет X рублей Y копеек. Определите размер вклада через год.


При решении этой задачи нельзя пользоваться условными инструкциями и циклами.

```c++
#include <iostream>

int main() {
    double p, x, y;

    std::cin >> p >> x >> y;

    double rub = x * (1 + p / 100);
    int res_rub = (int)rub;
    double cop = y * (1 + p / 100) + rub * 100 - res_rub * 100;
    res_rub += (int)cop / 100;
    int res_cop = (int)cop % 100;

    printf("%d %d", res_rub, res_cop);
    return 0;
}
```

```c++
#include <iostream>

int main() {
    int p, x, y;
	std::cin >> p >> x >> y;
	x = (x * 100 + y) * (p + 100) / 100;
	std::cout << x / 100 << " " << x % 100;
  return 0;
}
```

<hr>

[Содержание](#содержание)

## Процентная ставка по вкладу составляет P процентов годовых, которые прибавляются к сумме вклада через год.

Вклад составляет X рублей Y копеек. Определите размер вклада через K лет.

```c++
#include <iostream>

int main() {
    int p, x, y, k;
    std::cin >> p >> x >> y >> k;

    for (int i = 0; i < k; i++) {
        int res = (x * 100 + y) * (p + 100) / 100;
        x = res / 100;
        y = res % 100;
    }
    printf("%d %d", x, y);

    return 0;
}
```

```c++
#include <iostream>

int main() {
    double p, x, y;
    int k;
    std::cin >> p >> x >> y >> k;
    
    double sum = (x * 100 + y);
    
    while (k--) sum = int(sum + (sum * p) / 100);
    
    std::cout << int(sum / 100) << " " << sum - int(sum/100)*100;
}
```

<hr>

[Содержание](#содержание)

## Определите среднее значение всех элементов последовательности, завершающейся числом 0.

```c++
#include <iostream>

int main() {
    int n, count = 0;
    double result = 0;
    while (std::cin >> n && n != 0) {
        result += n;
        count++;
    }
    std::cout.precision(9);
    std::cout << result / count;
    return 0;
}
```

<hr>

[Содержание](#содержание)

## Дана последовательность натуральных чисел x1, x2, ..., xn. Стандартным отклонением называется величина

![01](/Introduction_to_Programming_Cpp/img/01_03.png)

где

![01](/Introduction_to_Programming_Cpp/img/01_04.png)

среднее значение последовательности.

Определите стандартное отклонение для данной последовательности натуральных чисел, завершающейся числом 0.

```c++
#include <cmath>
#include <iostream>
#include <vector>

int main() {
    int n, count = 0;
    std::vector<int> a;
    double mean = 0;
    while (std::cin >> n && n != 0) {
        a.push_back(n);
        mean += n;
        count++;
    }
    mean /= count;

    double result = 0;

    for (int i = 0; i < count; i++) {
        result += (a[i] - mean) * (a[i] - mean);
    }

    result = sqrt(result / --count);

    printf("%.11lf\n", result);

    return 0;
}
```

```c++
#include <cmath>
#include <iomanip>
#include <iostream>

int main() {
    using namespace std;
    // входное число, счетчик чисел, сумма чисел, сумма квадратов чисел
    int n, cnt = 0, sum = 0, sum2 = 0;
    // результат - стандартное отклонение
    double res;
    while (cin >> n && n != 0) {
        cnt++;
        // находим сумму и сумму квадратов
        sum += n;
        sum2 += n * n;
    }
    // для увеличения точности все возможные операции до
    // деления выполняем над целыми
    res = sqrt((double)(cnt * sum2 - sum * sum) / (cnt * (cnt - 1)));  // средне квадратичное отклонение
    cout << setprecision(11) << fixed;
    cout << res;
    return 0;
}
```

<hr>

[Содержание](#содержание)

## Дан многочлен 

$P(x)=a_n \cdot x^n + a_{n−1} \cdot x^{n−1} + … + a_1 \cdot x + a_0$ и число x. Вычислите значение этого многочлена, воспользовавшись схемой Горнера:

$P(x)=(…(((a_nx + a_{n−1})x + a_{n−2})x + a_{n−3}) … )x+ a_0$

Формат входных данных

Сначала программе подается на вход целое неотрицательное число n ≤ 20, затем действительное число x, затем следует n+1 вещественное число — коэффициенты многочлена от старшего к младшему.

```c++
#include <iomanip>
#include <iostream>

int main() {
    using namespace std;
    size_t count;
    double n, x, result = 0;
    cin >> count >> x;

    for (size_t i = 0; i <= count; i++) {
        cin >> n;
        result *= x;
        result += n;
    }
    cout << result;
    return 0;
}
```

<hr>

[Содержание](#содержание)

## Даны действительные коэффициенты a, b, c, при этом a ≠ 0 . Решите квадратное уравнение 
ax2 + bx + c = 0 и выведите все его корни.

Формат входных данных<br>
Вводятся три действительных числа.<br>
Формат выходных данных<br>
Если уравнение имеет два корня, выведите два корня в порядке возрастания, если один корень — выведите одно число, если нет корней — не выводите ничего.

```c
#include <cmath>
#include <iomanip>
#include <iostream>

void swap(double& a, double& b) {
    double tmp = a;
    a = b;
    b = tmp;
}

int main() {
    double a, b, c;
    std::cin >> a >> b >> c;

    double D = b * b - 4 * a * c;

    if (D < 0) return 0;

    double x1 = (-b + sqrt(D)) / (2 * a);
    double x2 = (-b - sqrt(D)) / (2 * a);

    if (x1 == x2)
        std::cout << x1;
    else {
        if (x1 > x2) swap(x1, x2);
        std::cout << x1 << " " << x2 << std::endl;
    }
    return 0;
}
```

<hr>

[Содержание](#содержание)

## Даны действительные коэффициенты a, b, c. Решите уравнение 
ax2 + bx + c = 0 и выведите все его корни.

```c
#include <cmath>
#include <iomanip>
#include <iostream>

void swap(double& a, double& b) {
    double tmp = a;
    a = b;
    b = tmp;
}

int main() {
    double a, b, c;
    std::cin >> a >> b >> c;

    if (a == 0) {
        if (b == 0) {
            if (c == 0) {
                std::cout << 3;
                return 0;
            } else {
                std::cout << 0;
                return 0;
            }
        } else {
            std::cout << 1 << " " << (double)c / -b;
            return 0;
        }
    }

    double D = b * b - 4 * a * c;

    if (D < 0) {
        std::cout << 0;
        return 0;
    }

    double x1 = (-b + sqrt(D)) / (2 * a);
    double x2 = (-b - sqrt(D)) / (2 * a);

    if (x1 == x2)
        std::cout << 1 << " " << x1;
    else {
        if (x1 > x2) swap(x1, x2);
        std::cout << 2 << " " << x1 << " " << x2;
    }
    std::cout << std::endl;
    return 0;
}
```

<hr>

[Содержание](#содержание)

## Даны вещественные числа a, b, c, d, e, f. Известно, что система линейных уравнений

![01](/Introduction_to_Programming_Cpp/img/01_05.png)

имеет ровно одно решение. Выведите два числа x и y, являющиеся решением этой системы.

```c++
#include <iostream>

int main() {
    double a, b, c, d, e, f;
    std::cin >> a >> b >> c >> d >> e >> f;

    double x = (b * f - d * e) / (b * c - d * a);
    double y = (c * e - f * a) / (b * c - d * a);

    std::cout << x << " " << y << std::endl;
    return 0;
}
```

<hr>

[Содержание](#содержание)

## Даны вещественные числа a, b, c, d, e, f. Известно, что система линейных уравнений Множество решений

![01](/Introduction_to_Programming_Cpp/img/01_05.png)

имеет ровно одно решение. Выведите два числа x и y, являющиеся решением этой системы.

Формат входных данных

Вводятся шесть чисел - коэффициенты уравнений системы.<br>
Формат выходных данных<br>
Вывод программы зависит от вида решения этой системы.
+ Если система не имеет решений, то программа должна вывести единственное число 0.
+ Если система имеет бесконечно много решений, каждое из которых имеет вид y=kx+n, то программа должна вывести число 1, а затем значения k и n.
+ Если система имеет единственное решение (x0, y0), то программа должна вывести число 2, а затем значения x0 и y0.
+ Если система имеет бесконечно много решений вида x=x0, y — любое, то программа должна вывести число 3, а затем значение x0.
+ Если система имеет бесконечно много решений вида y=y0, x — любое, то программа должна вывести число 4, а затем значение y0.
+ Если любая пара чисел (x, y)  является решением, то программа должна вывести число 5.

```c++
#include <iostream>
#include <cmath>
using namespace std;

double eps = 0.000001;
double norm(double x) {
    return fabs(x) <= eps ? 0 : x;
}

int main() {
    double a, b, c, d, e, f, x, y, n , k;
    cin >> a >> b >> c >> d >> e >> f;
    double D, Dx, Dy;
    D = a * d - b * c;
    Dx = e * d - b * f;
    Dy = a * f - e * c;
    if (D != 0) {
        cout << 2 << ' ' << norm(Dx / D) << ' ' << norm(Dy / D) << endl;
    } else {
        if (Dx == 0 && Dy == 0) {
            if (a == 0 && b == 0 && c == 0 && d == 0) {
                if (e != 0 || f != 0) {
                    cout << 0 << endl;
                } else {
                    cout << 5 << endl;
                }
            } else {
                if (a == 0 && c == 0) {
                    if (b != 0) {
                        y = e / b;
                        cout << 4 << ' ' << y << endl;
                    } else {
                        y = f / d;
                        cout << 4 << ' ' << y << endl;
                    }
                } else {
                    if (b == 0 && d == 0) {
                        if (a != 0) {
                            x = e / a;
                            cout << 3 << ' ' << x << endl;
                        } else {
                            x = f / c;
                            cout << 3 << ' ' << x << endl;
                        }
                    } else {
                        if (b != 0) {
                            n = e / b;
                            k = -a / b;
                            cout << 1 << ' ' << k << ' ' << n << endl;
                        } else {
                            n = f / d;
                            k = -c / d;
                            cout << 1 << ' ' << k << ' ' << n << endl;
                        }
                    }
                }
            }
        } else {
            cout << 0 << endl;
        }
    }
    return 0;
}
```

<hr>

[Содержание](#содержание)