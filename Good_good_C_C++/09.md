# 9  Движемся от Си к C++

# 9.1 C++. Начало

На заря 80-х годов, когда язык С достиг своего могущества и покрыл собой немалую часть программистского сообщества, из недр неуёмного сознания Бьёрна Струструппа явилось то, что в последствии стали кратко называть С++. Время разделилось на до и после. Непримиримые сторонники языка С напрочь отвергли зарождающееся явление С++, сохранив верность базовым принципам языка С.

Но историю было уже не остановить. И в 1983 году IT-мир содрогнулся. Язык C++ был официально признан новым языком программирования. 

Привычный порядок пришел в движение.
+ В C++ появились классы и объектно ориентированное программирование.
+ Структуры объединения стали специальными видами тех же классов. 
+ Появился механизм исключений.
+ Стала возможна перегрузка функций объявлений с аргументами по умолчанию.
+ Формированию inline и lambda функций.
+ Возникло то, что стало называться шаблонами и обобщенным программированием. Но и это еще не все.
+ В C++ появилось пространство имен,
+ новый способ объявления переменных через ссылки и вычисляемый тип,
+ возник самостоятельный булевый тип с двумя возможными стоянием `true` и `false`,
+ появились новые типы для символьных переменных,
+ новый вид цикла `for` для перебора последовательностей.
+ новый способ работы с потоком ввода вывода через объекты `cin`/`cout`
+  в обиход вошли такие операторы как `new` и `delete`. 

![09](/Good_good_C_C++/img/09_01.PNG)

И это лишь то не малое, что принес с собой C++. 

Потребовалось несколько лет кропотливой и напряженной работы, чтобы упорядочить все эти знания и лишь в 1998 году прийти к ратификации первого стандарта языка C++ под кодовым названием ISO-IC 14882.1998. 

С этого момента язык C++ было уже не остановить. 

Совсем скоро C++ поглотил стандартную библиотеку STL. Стали появляться все новые и новые стандарты — C++11, C++14, C++17, C++20. 

В ряды этого языка вступало все больше и больше программистов со всех уголков мира. На нем стали писать огромное количество проектов. Он проник везде где требовалась высокая скорость обработки данных, и в итоге стал конкурентом самому C. 

Оба языка C и C++ продолжили эволюционировать уже независимо друг от друга, как непримиримые враги.

И то, что ранее воспринималось как развитие, теперь по сути превратилось во два разных языка. 

Программа, написанная на современном C, почти наверняка не скомпилируется под C++. И наоборот.

Но несмотря на десятилетие эволюции, в ДНК языка C++ четко видны гены его предшественника. 

Эти следы C++ будет нести до конца своих дней, наследуя многие недостатки языка C. 

Но главное, внедрение в C++ многих популярных идей техник программирования превратили его в настоящего монстра. 

Сторонники языка считают это преимуществом. По их мнению, благодаря богатому функционалу можно реализовывать проекты самыми разными способами. 

И программист фактически ограничен только своими способностями. 

Противники же утверждают, что это часто приводит лишь к усложнению кода, сложности его понимания и дальнейшей модификации, особенно сторонними программистами. 

Мало того, в C++ гораздо больше подводных камней, нежели в языке C. Например, корпорация Google запретила своим разработчикам на C++ использовать механизмы исключения, потому что он часто приводит к заметному замедлению скорости работы программ. 

А это именно то, ради чего вообще стоит рассматривать язык C++ в качестве инструмента. 

Некоторые откровенно считают, что C++ ни при каких обстоятельствах не стоит применять при разработке больших проектов. Здесь можно привести известную цитату Линуса Торвальда. "Си плюс плюс – кошмарный язык». Его делает еще более кошмаром тот факт, множество недостаточных грамотных программистов используют его. Откровенно говоря, даже если нет никаких причин для выбора C, кроме того, чтобы держать программистов C++ подальше, то одного этого же будет достаточно веским основанием для использования C." 

Тем не менее, практика программирования показала, что грамотное применение языка C++ без фанатизма и неоправданного усложнения текста программы позволяет со всеми вытекающими плюсами и преимуществами перед языком C. 

Не зря C++ завоевал такую большую популярность, на которую способен далеко не каждый язык программирования. И главное, он остается востребованным и по сей день, несмотря на свою долголетнюю историю. 

Как вы уже догадались, в этом дополнение к курсу языка C мы не будем пускаться во все тяжкие, а рассмотрим лишь основные, базовые и часто применяемые возможности языка C++.

Мало того, я даже не буду опираться на какой-то определенный стандарт, ограничусь лишь стандартом не выше C++14. Все что нам будет нужно есть в нем. Итак, поехали.

Видео по теме [С++. Начало](https://www.youtube.com/watch?v=QYZbN2g-Dxc&list=PLA0M1Bcd0w8w-mqVmBjt-2J8Z1gVmPZVz)

# 9.2 Первая программа на С++

Первым делом нам нужно настроить среду программирования с компилятором языка С++. Для учебных целей вполне подойдет Visual Studio Code с ранее установленным компилятором `gcc`. Для проверки работоспособности компилятора достаточно открыть командное окно и ввести команду:

```
g++ --version
```

Если отобразится версия, значит, все настроено и готово к работе. Иначе, необходимо установить компилятор. О том, как это делается, рассказывается на одном из первых занятий по языку Си.

После этого я создам каталог:

```
D:\Projects\vscode\course_cpp
```

в котором будут размещаться файлы с программой на С++ и соответствующие исполняемые файлы. У вас может быть любой другой маршрут расположения файлов. Старайтесь только в названиях не использовать кириллицу и символы пробела.

Перейдем в программу Visual Studio Code и откроем созданную папку. Нажмем «New File...» и создадим текстовый файл с именем:

```
course.cpp
```

Обратите внимание на расширение файла – cpp. Модули с текстами программ на языке С++ принято сохранять с таким расширением.

Далее, запишем первую программу на С++. Она будет следующей:

```cpp
// Первая программа на языке С++
#include <iostream>
 
int main() {
    std::cout << "Hello World!" << std::endl;
    
    return 0;
}
```

Позже я поясню, что означают все эти строчки, а вначале давайте попробуем ее скомпилировать и запустить. 

Для этого я из папки с программой на чистом Си скопирую каталог .vscode с настроечными JSON-файлами. 

И открою в VS Code файл settings.json. В этом файле прописаны связи между расширениями файлов и соответствующими запусками компиляторов. В частности, для расширения cpp используется компилятор g++. В целом, меня здесь все устраивает, дополнительно только пропишу версию стандарта этого компилятора С++14 следующим образом:

```
cd $dir && g++ -std=c++14 $fileName -o $fileNameWithoutExt && $dir$fileNameWithoutExt
```

Попробуем теперь откомпилировать и запустить программу (Ctrl + Alt + n). Видим на экране сообщение «Hello World!».

И сделаем еще одну настройку автоматической прокрутки скроллинга вкладки OUTPUT среды VS Code. Для этого перейдем в настройки (File -> Preferences -> Settings). Здесь выберем Features -> Output и уберем галочку у «Smart Scroll».

Давайте, теперь вернемся к самой программе и разберемся, из чего она состоит. В первой строчке записан однострочный комментарий (появился в языке С++) и все, что идет после символов `//` до конца строки помечается, как комментарий. 

Причем, однострочное комментирование не обязательно начинать с начала строки, его можно указать в любом месте, например, после объявления заголовка функции `main`:

```cpp
int main()  // точка входа в программу
```

Для одной строки такие комментарии прописывать гораздо удобнее, чем `/* */`, которые изначально были определены в языке Си. В С++ можно применять оба вида.

Следующая строчка – это уже знакомая вам директива `#include` для включения файла `iostream` в текущем модуле. 

В данном случае это необходимо для использования объекта `cout`, с помощью которого удобно выводить данные в стандартный выходной поток `stdout`. 

Ранее, в языке Си, мы для этой цели часто использовали функцию `printf()`. В языке С++ этот процесс несколько упрощен благодаря объекту `cout`. Что это за объект и как он в деталях работает, речь еще впереди.

Далее, идет стандартная функция `main()`, которая определяет точку входа в программу, то есть, в языке С++ (также, как и в языке Си) программа начинает выполняться с автоматического вызова функции `main()` и завершается, при ее завершении.

Следующая конструкция:

```c
std::cout << "Hello World!" << std::endl;
```
отвечает за вывод информации в стандартный выходной поток. Здесь в глаза бросается фрагмент `std::…`. 
Ключевое слово `std` – это предопределенное название пространства имен, так называемой, стандартной библиотеки языка С++. 

Как я отмечал во вступлении, в язык С++ на уровне стандарта включили библиотеку `STL`, которая заметно упрощает работу со сложными коллекциями и типами данных, таких как:
+ строки `(std::string)`;
+ массивы `(std::array)`;
+ динамический массив `(std::vector)`;
+ двухсвязный список `(std::list)`;
+ очередь `(std::deque)`;
+ упорядоченные множества `(std::set)`;
+ упорядоченные ассоциативные массивы `(std::map)`

и многое другое. 

Так вот, чтобы обратиться к тому или иному определению в пространстве стандартной библиотеки, следует прописать название этого пространства `std` и через два двоеточия (четвероточие) указать нужный элемент. 

В частности, `cout` – это объект класса `ostream`, который отвечает за вывод информации в стандартный выходной поток. Затем, используя переопределенную операцию `<<`, указываются выводимые данные. 

В конце, после вывода строки «Hello World!» прописан `endl`. Он передает символ переноса строки и очищает буфер потока, к которому применен.

Вас может удивить, что для понимания работы такой простой программы на С++ нужно знать и о пространстве имен, и об объектах классов, и, по-хорошему, о самих классах. 

Это, действительно, так. 

Конечно, на начальном этапе подобные моменты можно просто запомнить и применять без глубокого понимания их работы. 

Часто так и делается. 

В конце концов, язык С++ (равно, как и Си) был придуман не для обучения программированию, а чтобы дать программистам эффективный и высокоуровневый инструмент разработки программ качественно транслирующихся в машинный код, то есть, выполняющихся с наибольшей скоростью. 

Поэтому, если вам не понятны слова «объект», «класс», «пространство имен» и прочее, то пока просто запоминайте приведенные конструкции по факту, а более глубокое понимание придет позже.

Итак, на этом занятии мы с вами сделали первый шаг в языке С++. Настроили интегрированную среду с компилятором g++ стандарта C++14, написали и выполнили первую простую программу. На следующем занятии уже непосредственно начнем изучать конструкции языка С++.

Видео по теме [#1. Первая программа на С++](https://www.youtube.com/watch?v=c7Nb0lJHVtU&list=PLA0M1Bcd0w8w-mqVmBjt-2J8Z1gVmPZVz)

### Подвиг 1. Выберите все верные утверждения, касающиеся языка программирования C++.

+ [x] автором языка С++ является Бьерн Страуструп
+ [x] язык С++ появился как развитие языка Си
+ [x] концептуально язык С++ отличается от языка Си объектно-ориентированным подходом к программированию (ООП) и обобщенным программированием (шаблонами)
+ [x] язык С++ имеет гораздо больше возможностей, чем язык Си, но и накладывает на программиста больше ответственности при написании программ
+ [x] современная программа, написанная на языке Си, может не скомпилироваться под С++
+ [x] в С++ гораздо больше "подводных камней", нежели в языке Си

### Подвиг 2. Как в тексте программы на С++ оформляются комментарии?

+ [x] `//` (однострочный комментарий)
+ [ ] `\* *\` (многострочный комментарий)
+ [x] `/* */` (многострочный комментарий)
+ [ ] `\\` (однострочный комментарий)

### Подвиг 3. Какую роль играет функция main() в тексте программы на языке C++?

+ [x] если функция main() возвращает 0, значит, программа была выполнена успешно (без ошибок)
+ [ ] если функция main() возвращает не нулевое значение, значит, программа была выполнена успешно (без ошибок)
+ [x] как только функция main() завершает свою работу, завершается выполнение всей программы
+ [ ] функция main() служит для начальной инициализации переменных в программе (и только для этого)
+ [x] это функция, которая автоматически запускается при запуске исполняемого файла
+ [x] если функция main() отсутствует в тексте программы (проекта), то при компиляции возникает ошибка

### Подвиг 4 (на повторение). Какую роль играет текстовый препроцессор при компиляции программы на языке C/C++?

+ [x] обрабатывает директивы препроцессора в исходных файлах текстов программы
+ [ ] выполняет сборку объектных модулей программы в единый исполняемый файл
+ [ ] обрабатывает директивы препроцессора в полученных объектных файлах
+ [ ] добавляет специальные директивы в текст программы для оптимизации процесса компиляции

### Подвиг 5 (на повторение). Какую роль играет непосредственно компилятор при транслировании программы на языке C/C++ в машинный код?

+ [x] отдельные файлы с текстами программы преобразует в машинный код, формируя объектные файлы
+ [ ] объединяет все файлы с текстами программы текущего проекта в единую программу и переводит ее в машинный код
+ [ ] выполняет сборку объектных модулей программы в единый исполняемый файл
+ [ ] отдельные файлы с текстами программы преобразует в машинный код, формируя конечный исполняемый файл

### Подвиг 6 (на повторение). Какую роль играет линкер (редактор связей) при компиляции программы на языке C/C++?

+ [ ] соединяет между собой объектные файлы, формируя единую программу, без добавления какой-либо дополнительной информации
+ [ ] соединяет между собой объектные файлы, формируя единую программу, добавляет код запуска и коды всех библиотечных функций используемых в программе библиотек
+ [ ] объединяет все файлы с текстами программы текущего проекта в единую программу и переводит ее в машинный код
+ [x] соединяет между собой объектные файлы, формируя единую программу, добавляет код запуска и коды используемых библиотечных функций

### Подвиг 7. Напишите по аналогии (с рассмотренной на этом занятии) программу на C++ с выводом на экран строки "I love C++" по следующей схеме:

1. Подключите заголовок `iostream`
2. Запишите функцию `main()`, которая возвращает целочисленное значение типа `int`.
3. В теле функции main с помощью объекта `std::cout` выведите в консоль указанную строку с переводом на новую строку, используя функцию `std::endl`.
4. Пропишите оператор `return`, который возвращает целое число `0`.

P. S. Постарайтесь соблюдать оформление программы, приведенное на этом занятии.

```c
#include <iostream>

int main() {
    std::cout << "I love C++" << std::endl;

    return 0;
}
```

# 9.3 Ввод-вывод с помощью объектов cin и cout